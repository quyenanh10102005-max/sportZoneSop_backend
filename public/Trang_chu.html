<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SportZoneVN</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="Trang_chu.css">
</head>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<body>
    <div class="welcome">Chào mừng đến với SportZoneVn - Giày bóng đá chính hãng Việt Nam</div>


    <header id="mainHeader">
<div class="header-logo"><img src="/images/Logo_.png" alt="SportZoneVN Logo"></div>
   <div class="header-search">
    <i class="fa-solid fa-magnifying-glass"></i>
     <input  type="text" placeholder="Tìm kiếm sản phẩm ...">
     </div> 

  <div class="header_menu">
       <i class="fa-solid fa-user" id="userIcon"></i>
    <span id="userName" style="margin-left: 8px; font-weight: bold; display:none;"></span> <ul class="header_main_menu" id="menuList">
        <li id="welcomeMessage" style="padding: 10px 15px; font-weight: bold; display: none;">Xin chào, <span id="welcomeUserName"></span></li>
        <li id="registerLi"><a href="./Dang_ky.html">Đăng ký</a></li>
        <li id="loginLi"><a href="./Dang_nhap.html">Đăng nhập</a></li>
        <li id="logoutLi"><a href="#" style="color: #dc3545;">Đăng xuất</a></li>
    </ul>
  </div>
 <div class="header_gio_hang">
  <a href="Gio_Hang.html">
    <i class="fa-solid fa-cart-shopping" data-count="0"></i>
  </a>
</div>
    </header>

    <nav>
  <ul class="main_menu">
    <li><a href="Trang_chu.html">Trang chủ</a></li>

    <li class="submenu">
      <a href="#">Giày bóng đá</a>
      <ul class="has_submenu">
        <li><a href="Danh_Sach_San_Pham.html">Tất cả sản phẩm</a></li>
        <li><a href="Danh_Sach_San_Pham.html?loai=Sân cỏ nhân tạo">Giày sân cỏ nhân tạo</a></li>
        <li><a href="Danh_Sach_San_Pham.html?loai=Sân cỏ tự nhiên">Giày sân cỏ tự nhiên</a></li>
        <li><a href="Danh_Sach_San_Pham.html?loai=Sân Futsal">Giày sân Futsal</a></li>
      </ul>
    </li>

    <li class="submenu">
      <a href="#">Thương hiệu</a>
      <ul class="has_submenu">
        <li><a href="Danh_Sach_San_Pham.html?thuongHieu=Nike">Nike</a></li>
        <li><a href="Danh_Sach_San_Pham.html?thuongHieu=Adidas">Adidas</a></li>
        <li><a href="Danh_Sach_San_Pham.html?thuongHieu=Puma">Puma</a></li>
        <li><a href="Danh_Sach_San_Pham.html?thuongHieu=Mizuno">Mizuno</a></li>
        <li><a href="Danh_Sach_San_Pham.html?thuongHieu=Kamito">Kamito</a></li>
        <li><a href="Danh_Sach_San_Pham.html?thuongHieu=Zocker">Zocker</a></li>
      </ul>
    </li>

    <li><a href="Phu_Kien.html">Phụ kiện</a></li>
    <li><a href="Tin_Tuc_Giay.html">Tin tức giày</a></li>
    <li><a href="Khuyen_Mai.html">Khuyến mãi</a></li>
    <li><a href="Ve_chung_toi.html">Về chúng tôi</a></li>
  </ul>
</nav>


    <main>

      <div class="carousel slide" id="productCarousel" data-bs-ride="carousel" data-bs-interval="3000">

        <div class="carousel-inner">
          <div class="carousel-item active">
            <img src="/images/brand_banner_1.jpg" class="d-block w-100" alt="Banner giày Nike">
          </div>

          <div class="carousel-item ">
            <img src="/images/brand_banner_2.jpg" class="d-block w-100" alt="Banner giày Adidas">
          </div>

          <div class="carousel-item ">
            <img src="/images/index_banner_6.jpg" class="d-block w-100" alt="Banner khuyến mãi">
          </div>

          <div class="carousel-item ">
            <img src="/images/index_banner_7.jpg" class="d-block w-100" alt="Banner giày mới">
          </div>
        </div>
      
      <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>

      <div class="carousel-indicators">
          <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
          <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
          <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
          <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
        </div>

        </div>
    </main>
    

    <div>
           <section class="container mt-5">
  <h2 class="mb-4 text-center" style="color:#333; font-weight: 700; border-bottom: 2px solid #667eea; display: inline-block; padding-bottom: 5px;">SẢN PHẨM MỚI NHẤT</h2>
  <div class="row" id="ds-sanpham"></div>
</section>
    </div>






    <footer>
      <div class="footer-section footer-info">
        <h2>THÔNG TIN LIÊN HỆ</h2>
        <p style="font-weight: bold; color: #ffffff;">SportZoneVN - Giày bóng đá chính hãng</p>
        <p><i class="fa-solid fa-location-dot"></i> Địa chỉ: Đông Yên - Đông Sơn - Thanh Hóa</p>
        <p><i class="fa-solid fa-phone"></i> Hotline: 0329127111</p>
        <p><i class="fa-solid fa-envelope"></i> Email: Doaducthiendeptrai@gmail.com</p>
      </div>

      <div class="footer-section footer-links">
        <h2>HỖ TRỢ KHÁCH HÀNG</h2>
        <ul>
          <li><a href="#">Hướng dẫn đặt hàng</a></li>
          <li><a href="#">Chính sách bảo mật</a></li>
          <li><a href="#">Chính sách đổi trả</a></li>
          <li><a href="#">FAQ - Câu hỏi thường gặp</a></li>
        </ul>
      </div>

       <div class="footer-section footer-social">
        <h2>KẾT NỐI VỚI CHÚNG TÔI</h2>
        <div class="lien_ket">
         <a href="https://www.facebook.com/thien.uc.609096" target="_blank" aria-label="Facebook">
          <i class="fa-brands fa-square-facebook"></i>
         </a>

         <a href="https://www.instagram.com/qanh1010/" target="_blank" aria-label="Instagram">
          <i class="fa-brands fa-square-instagram"></i>
         </a>

         <a href="https://www.youtube.com/@quyenanh8600" target="_blank" aria-label="Youtube">
          <i class="fa-brands fa-youtube"></i>
         </a>
        </div>
      </div>
    </footer>
     <div class="gb">© 2025 SportZoneVn - Giày bóng đá chính hãng Việt Nam. All Rights Reserved.</div>


    




     <script>
 // ======================= CHỈNH SỬA XỬ LÝ ĐĂNG NHẬP/ĐĂNG XUẤT =======================
  const user = localStorage.getItem("user");

  const userNameSpan = document.getElementById("userName");
  const welcomeMessageLi = document.getElementById("welcomeMessage");
  const welcomeUserNameSpan = document.getElementById("welcomeUserName");
  const registerLi = document.getElementById("registerLi");
  const loginLi = document.getElementById("loginLi");
  const logoutLi = document.getElementById("logoutLi");

  if (user) {
    // Nếu đã đăng nhập
    const userData = JSON.parse(user);
    const displayUsername = userData.TenDangNhap.length > 15 ? userData.TenDangNhap.substring(0, 15) + '...' : userData.TenDangNhap;

    // userNameSpan.textContent = displayUsername; // Giữ lại nếu muốn hiện tên cạnh icon
    welcomeUserNameSpan.textContent = displayUsername;
    welcomeMessageLi.style.display = "block";

    registerLi.style.display = "none";
    loginLi.style.display = "none";
    logoutLi.style.display = "block";
  } else {
    // Nếu chưa đăng nhập
    userNameSpan.textContent = "";
    welcomeMessageLi.style.display = "none";
    registerLi.style.display = "block";
    loginLi.style.display = "block";
    logoutLi.style.display = "none";
  }

  // Xử lý nút Đăng xuất
  logoutLi.querySelector('a').addEventListener('click', function(e) {
    e.preventDefault();
    localStorage.removeItem('token');
    localStorage.removeItem('user');
    window.location.href = "Dang_nhap.html";
  });
  
 // ======================= HIỆU ỨNG STICKY HEADER =======================
const header = document.getElementById('mainHeader');
const sticky = header.offsetTop;

function stickyHeader() {
  if (window.scrollY > 0) {
    header.classList.add("header-scrolled");
  } else {
    header.classList.remove("header-scrolled");
  }
}
window.onscroll = stickyHeader;
</script>




  <script>
// ======================= TÌM KIẾM TỪ HEADER =======================
const searchInput = document.querySelector('.header-search input');

searchInput.addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    const query = this.value.trim();
    if (query) {
      window.location.href = `Danh_Sach_San_Pham.html?q=${encodeURIComponent(query)}`;
    }
  }
});

// Thêm icon search có thể click
document.querySelector('.header-search i').addEventListener('click', function() {
  const query = searchInput.value.trim();
  if (query) {
    window.location.href = `Danh_Sach_San_Pham.html?q=${encodeURIComponent(query)}`;
  }
});


// ======================= LẤY DANH SÁCH SẢN PHẨM =======================
fetch('/api/sanpham')
  .then(res => res.json())
  .then(data => {
    const container = document.getElementById('ds-sanpham');
    const validProducts = data.filter(sp => sp.ten && sp.gia);

    if (validProducts.length === 0) {
      container.innerHTML = `<p class="text-center text-muted">Chưa có sản phẩm nào để hiển thị.</p>`;
      return;
    }

    container.innerHTML = validProducts.map(sp => {
      // Tự động nhận diện thương hiệu từ tên
      const brandName = detectBrand(sp.ten);
      
      return `
        <div class="col-6 col-md-4 col-lg-3 mb-4"> <div class="card h-100 shadow-sm product-card" onclick="window.location.href='San_Pham.html?id=${sp._id}'" style="cursor:pointer; border: none; transition: transform 0.3s, box-shadow 0.3s;">
             <div style="position: absolute; top: 10px; left: 10px; background: #dc3545; color: white; padding: 3px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; z-index: 10;">NEW</div>
            <img src="${sp.hinhAnh ? sp.hinhAnh : '/images/default-shoe.jpg'}" 
                 class="card-img-top" 
                 alt="${sp.ten}"
                 style="height: 180px; object-fit: cover; border-radius: 8px 8px 0 0;">
            <div class="card-body text-center">
              <p class="text-muted" style="font-size: 12px; margin-bottom: 5px;">${brandName || 'Chưa rõ thương hiệu'}</p>
              <h6 class="card-title" style="font-weight: 600; font-size: 15px; height: 40px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;">${sp.ten}</h6>
              <p class="text-danger fw-bold mt-2" style="font-size: 18px;">${Number(sp.gia).toLocaleString()}₫</p>
            </div>
          </div>
        </div>
      `;
    }).join('');
    
    // Thêm hiệu ứng hover cho card sản phẩm
    document.querySelectorAll('.product-card').forEach(card => {
        card.addEventListener('mouseenter', () => {
            card.style.transform = 'translateY(-5px)';
            card.style.boxShadow = '0 15px 30px rgba(0,0,0,0.1)';
        });
        card.addEventListener('mouseleave', () => {
            card.style.transform = 'translateY(0)';
            card.style.boxShadow = '0 5px 15px rgba(0,0,0,0.05)';
        });
    });
  })
  .catch(err => {
    console.error('Lỗi khi tải sản phẩm:', err);
    document.getElementById('ds-sanpham').innerHTML =
      `<p class="text-center text-danger">Không thể tải danh sách sản phẩm.</p>`;
  });

//  Hàm nhận diện thương hiệu từ tên
function detectBrand(productName) {
  const brands = ['Nike', 'Adidas', 'Puma', 'Mizuno', 'Kamito', 'Zocker'];
  const nameLower = productName.toLowerCase();
  
  for (const brand of brands) {
    if (nameLower.includes(brand.toLowerCase())) {
      return brand;
    }
  }
  return null;
}

// ======================= CẬP NHẬT SỐ LƯỢNG GIỎ HÀNG =======================
async function updateCartCount() {
  const user = JSON.parse(localStorage.getItem('user'));
  const cartIcon = document.querySelector('.header_gio_hang i');

  if (!user || !user.MaTK) {
      if(cartIcon) cartIcon.setAttribute('data-count', 0);
      return;
  }

  try {
    const res = await fetch(`/api/giohang/${user.MaTK}`);
    if (!res.ok) throw new Error('Không thể lấy giỏ hàng');
    
    const cart = await res.json();
    const count = cart.length || 0;

    // Hiển thị badge số lượng
    if (cartIcon) {
      cartIcon.setAttribute('data-count', count);
    }
    
  } catch (err) {
    console.error('Lỗi cập nhật giỏ hàng:', err);
     if(cartIcon) cartIcon.setAttribute('data-count', 0);
  }
}

// Gọi khi load trang
updateCartCount();
</script>
</body>


</html>